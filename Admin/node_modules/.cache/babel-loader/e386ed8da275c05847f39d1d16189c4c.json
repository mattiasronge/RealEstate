{"remainingRequest":"/Users/mattiasronge/Desktop/richar/Admin/node_modules/babel-loader/lib/index.js!/Users/mattiasronge/Desktop/richar/Admin/node_modules/eslint-loader/index.js??ref--13-0!/Users/mattiasronge/Desktop/richar/Admin/src/store/modules/customer.js","dependencies":[{"path":"/Users/mattiasronge/Desktop/richar/Admin/src/store/modules/customer.js","mtime":1577394733929},{"path":"/Users/mattiasronge/Desktop/richar/Admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mattiasronge/Desktop/richar/Admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/mattiasronge/Desktop/richar/Admin/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport axios from 'axios';\nvar url = process.env.VUE_APP_BACKEND_URL + 'api/';\nvar state = {\n  customers: [],\n  ref_keys: [],\n  customer_ref_keys: [],\n  customer: {\n    url_key: '',\n    name: '',\n    email: '',\n    phone: '',\n    message: ''\n  },\n  clientPage: {\n    customer: '',\n    url_key: '',\n    is_notify: false,\n    products_a: [],\n    products_a_ids: [],\n    products_m: [],\n    products_m_ids: []\n  }\n}; // getters\n\nvar getters = {}; // mutations\n\nvar mutations = {\n  getRefKeys: function getRefKeys(state, data) {\n    state.ref_keys = data;\n  },\n  getCustomers: function getCustomers(state, data) {\n    state.customers = data;\n  },\n  getCustomer: function getCustomer(state, post) {\n    state.customer = post;\n  },\n  getClientPage: function getClientPage(state, post) {\n    state.customer.url_key = post.url_key;\n    state.clientPage = post;\n    var products_m_ids = [];\n    post.products_m.forEach(function (item) {\n      if (item && item._id) {\n        products_m_ids.push(item._id);\n      }\n    });\n    var products_a_ids = [];\n    state.customer_ref_keys = [];\n    post.products_a.forEach(function (item) {\n      if (item && item._id) {\n        products_a_ids.push(item._id);\n        state.customer_ref_keys.push(item.ref_key);\n      }\n    });\n    state.clientPage.products_m_ids = products_m_ids;\n    state.clientPage.products_a_ids = products_a_ids; //console.log(state.customer_ref_keys);\n  },\n  emptyCustomer: function emptyCustomer(state) {\n    state.customer = {\n      url_key: '',\n      name: '',\n      email: '',\n      phone: '',\n      message: ''\n    };\n  }\n}; // actions\n\nvar actions = {\n  getRefKeys: function getRefKeys(_ref) {\n    var commit = _ref.commit;\n    axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\n    axios.get(process.env.VUE_APP_BACKEND_URL + 'productapi/refkey').then(function (response) {\n      commit('getRefKeys', response.data);\n    });\n  },\n  getCustomers: function getCustomers(_ref2) {\n    var commit = _ref2.commit;\n    axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\n    axios.get(url + 'usercustomer').then(function (response) {\n      commit('getCustomers', response.data);\n    });\n  },\n  getCustomer: function getCustomer(context, params) {\n    axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\n    axios.get(url + 'usercustomer/' + params.id).then(function (response) {\n      context.commit('getCustomer', response.data);\n    });\n  },\n  getClientPage: function getClientPage(context, params) {\n    state.customer._id = params.client;\n\n    if (params.url_key != '') {\n      axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\n      axios.get(url + 'customerpage/' + params.url_key).then(function (response) {\n        context.commit('getClientPage', response.data);\n      });\n    } else {\n      context.commit('getClientPage', {\n        url_key: '',\n        customer: {\n          _id: params.client\n        },\n        products_m: [],\n        products_a: [],\n        products_s: [],\n        is_notify: false\n      });\n    }\n  },\n  saveClientPage: function saveClientPage(context, params) {\n    state.clientPage.products_m = state.clientPage.products_m_ids;\n    state.clientPage.products_a = state.clientPage.products_a_ids;\n\n    if (params.url_key == '') {\n      axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\n      axios.post(url + 'customerpage', state.clientPage).then(function (response) {\n        context.commit('getClientPage', response.data);\n        context.dispatch('saveUrl_key', {\n          id: params.client,\n          url_key: state.customer.url_key\n        });\n      });\n    } else {\n      axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\n      axios.put(url + 'customerpage/' + params.url_key, state.clientPage).then(function (response) {\n        context.commit('getClientPage', response.data);\n      });\n    }\n  },\n  emptyCustomer: function emptyCustomer(_ref3) {\n    var commit = _ref3.commit;\n    commit('emptyCustomer');\n  },\n  deleteCustomer: function deleteCustomer(_ref4, params) {\n    var dispatch = _ref4.dispatch;\n    axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\n    axios.delete(url + 'usercustomer/' + params.id).then(function (response) {\n      if (state.customer.url_key != '') {\n        axios.delete(url + 'customerpage/' + params.url_key).then(function () {\n          dispatch('getCustomers', response.data);\n        });\n      }\n\n      dispatch('getCustomers', response.data);\n    });\n  },\n  saveUrl_key: function saveUrl_key(_ref5, params) {\n    var dispatch = _ref5.dispatch;\n\n    if (params.id != '' && params.url_key != '') {\n      //edit Customer\n      axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\n      axios.put(url + 'usercustomer/' + params.id, {\n        url_key: params.url_key\n      }).then(function (response) {\n        dispatch('getCustomers', response.data);\n      });\n    }\n  },\n  saveCustomer: function saveCustomer(_ref6, params) {\n    var dispatch = _ref6.dispatch;\n\n    if (params.id && params.id != '') {\n      //edit Customer\n      axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\n      axios.put(url + 'usercustomer/' + params.id, state.customer).then(function (response) {\n        dispatch('getCustomers', response.data);\n      });\n    } else {\n      //insert Customer\n      axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\n      axios.post(url + 'usercustomer', state.customer).then(function (response) {\n        dispatch('getCustomers', response.data);\n      });\n    }\n  }\n};\nexport default {\n  namespaced: true,\n  state: state,\n  getters: getters,\n  actions: actions,\n  mutations: mutations\n};",{"version":3,"sources":["/Users/mattiasronge/Desktop/richar/Admin/src/store/modules/customer.js"],"names":["axios","url","process","env","VUE_APP_BACKEND_URL","state","customers","ref_keys","customer_ref_keys","customer","url_key","name","email","phone","message","clientPage","is_notify","products_a","products_a_ids","products_m","products_m_ids","getters","mutations","getRefKeys","data","getCustomers","getCustomer","post","getClientPage","forEach","item","_id","push","ref_key","emptyCustomer","actions","commit","defaults","headers","common","get","then","response","context","params","id","client","products_s","saveClientPage","dispatch","put","deleteCustomer","delete","saveUrl_key","saveCustomer","namespaced"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\nconst url = process.env.VUE_APP_BACKEND_URL+'api/';\r\nconst state = {\r\n    customers: [],\r\n    ref_keys: [],\r\n    customer_ref_keys: [],\r\n    customer: {\r\n        url_key:'',\r\n        name:'',\r\n        email:'',\r\n        phone:'',\r\n        message:''\r\n    },\r\n    clientPage: {\r\n        customer:'',\r\n        url_key: '',\r\n        is_notify:false,\r\n        products_a:[],\r\n        products_a_ids:[],\r\n        products_m:[],\r\n        products_m_ids:[],\r\n    }\r\n}\r\n\r\n// getters\r\nconst getters = {\r\n\r\n}\r\n// mutations\r\nconst mutations = {\r\n    getRefKeys(state, data) {\r\n        state.ref_keys = data;\r\n    },\r\n    getCustomers(state, data) {\r\n        state.customers = data;\r\n    },\r\n    getCustomer(state, post) {\r\n        state.customer = post\r\n    },\r\n    getClientPage(state, post) {\r\n        state.customer.url_key = post.url_key;\r\n        state.clientPage = post;\r\n\r\n        let products_m_ids = [];\r\n        post.products_m.forEach(item => {\r\n            if (item && item._id) {\r\n                products_m_ids.push(item._id);\r\n            }\r\n        });\r\n\r\n        let products_a_ids = [];\r\n        state.customer_ref_keys = [];\r\n        post.products_a.forEach(item => {\r\n            if (item && item._id) {\r\n                products_a_ids.push(item._id);\r\n                state.customer_ref_keys.push(item.ref_key);\r\n            }\r\n        });\r\n\r\n        state.clientPage.products_m_ids = products_m_ids;\r\n        state.clientPage.products_a_ids = products_a_ids;\r\n        //console.log(state.customer_ref_keys);\r\n    },\r\n    emptyCustomer(state) {\r\n        state.customer = {\r\n            url_key:'',\r\n            name:'',\r\n            email:'',\r\n            phone:'',\r\n            message:''\r\n        };\r\n    },\r\n};\r\n\r\n// actions\r\nconst actions = {\r\n    getRefKeys({commit}) {\r\n        axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\r\n        axios.get(process.env.VUE_APP_BACKEND_URL+'productapi/refkey').then((response) => {\r\n            commit('getRefKeys', response.data);\r\n        });\r\n    },\r\n    getCustomers({commit}) {\r\n        axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\r\n        axios.get(url+'usercustomer').then((response) => {\r\n            commit('getCustomers', response.data);\r\n        });\r\n    },\r\n    getCustomer(context, params) {\r\n        axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\r\n        axios.get(url+'usercustomer/'+params.id).then((response) => {\r\n            context.commit('getCustomer', response.data);\r\n        });\r\n    },\r\n    getClientPage(context, params) {\r\n        state.customer._id = params.client;\r\n        if (params.url_key!=''){\r\n            axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\r\n            axios.get(url+'customerpage/'+params.url_key).then((response) => {\r\n                context.commit('getClientPage', response.data);\r\n            });\r\n        }\r\n        else {\r\n            context.commit('getClientPage', {\r\n                url_key:'',\r\n                customer: {_id:params.client},\r\n                products_m:[],\r\n                products_a:[],\r\n                products_s:[],\r\n                is_notify:false\r\n            });\r\n        }\r\n    },\r\n    saveClientPage(context, params) {\r\n        state.clientPage.products_m = state.clientPage.products_m_ids;\r\n        state.clientPage.products_a = state.clientPage.products_a_ids;\r\n\r\n        if (params.url_key=='') {\r\n            axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\r\n            axios.post(url+'customerpage', state.clientPage).then((response) => {\r\n                context.commit('getClientPage', response.data);\r\n                context.dispatch('saveUrl_key', {id: params.client, url_key: state.customer.url_key});\r\n            });\r\n        }\r\n        else {\r\n            axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\r\n            axios.put(url+'customerpage/'+params.url_key, state.clientPage).then((response) => {\r\n                context.commit('getClientPage', response.data);\r\n            });\r\n        }\r\n    },\r\n    emptyCustomer({commit}) {\r\n        commit('emptyCustomer');\r\n    },\r\n    deleteCustomer({dispatch}, params) {\r\n        axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\r\n        axios.delete(url+'usercustomer/'+params.id).then((response) => {\r\n            if (state.customer.url_key!='')\r\n            {\r\n                axios.delete(url+'customerpage/'+params.url_key).then(() => {\r\n                    dispatch('getCustomers', response.data)\r\n                });\r\n            }\r\n            dispatch('getCustomers', response.data)\r\n        });\r\n    },\r\n    saveUrl_key({dispatch}, params) {\r\n        if (params.id!='' && params.url_key!='')\r\n        {\r\n            //edit Customer\r\n            axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\r\n            axios.put(url+'usercustomer/'+params.id, {url_key: params.url_key}).then((response) => {\r\n                dispatch('getCustomers', response.data)\r\n            });\r\n        }\r\n    },\r\n    saveCustomer({dispatch}, params) {\r\n        if (params.id && params.id!='')\r\n        {\r\n            //edit Customer\r\n            axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\r\n            axios.put(url+'usercustomer/'+params.id, state.customer).then((response) => {\r\n                dispatch('getCustomers', response.data)\r\n            });\r\n        } else {\r\n            //insert Customer\r\n            axios.defaults.headers.common['Access-Control-Allow-Origin'] = '*';\r\n            axios.post(url+'usercustomer', state.customer).then((response) => {\r\n                dispatch('getCustomers', response.data)\r\n            });\r\n        }\r\n    },\r\n}\r\n\r\nexport default {\r\n\tnamespaced: true,\r\n\tstate,\r\n\tgetters,\r\n\tactions,\r\n\tmutations\r\n}"]}]}